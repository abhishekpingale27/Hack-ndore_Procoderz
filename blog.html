<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Admin Dashboard</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<style>
		body {
			font-family: Arial, sans-serif;
			background-color: #f4f4f4;
		}

		.navbar {
			background-color: #333;
			color: #fff;
		}

		.navbar a,
		.navbar a:hover {
			color: #fff;
		}

		.sidebar {
			height: 100vh;
			background-color: #343a40;
			padding-top: 20px;
		}

		.sidebar a {
			color: #ddd;
			padding: 15px;
			text-decoration: none;
			display: block;
		}

		.sidebar a:hover {
			background-color: #575d63;
			color: #fff;
		}

		.content {
			margin-left: 250px;
			padding: 20px;
		}

		.card {
			margin-bottom: 20px;
		}
	</style>
</head>

<body>
	<!-- Navbar -->
	<nav class="navbar navbar-expand-lg navbar-dark">
		<a class="navbar-brand" href="#">Admin Dashboard</a>
		<ul class="navbar-nav ml-auto">
			<li class="nav-item dropdown">
				<a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown"
					aria-haspopup="true" aria-expanded="false">
					<i class="fa fa-user"></i> Admin Name
				</a>
				<div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
					<a class="dropdown-item" href="#">Logout</a>
				</div>
			</li>
		</ul>
	</nav>

	<!-- Sidebar -->
	<div class="d-flex">
		<div class="sidebar bg-dark">
			<a href="#overview">Overview</a>
			<a href="#scheduling">Scheduling</a>
			<a href="#roster">Roster Management</a>
			<a href="#work-orders">Work Orders</a>
			<a href="#employees">Employees</a>
			<a href="#fuel">Fuel Monitoring</a>
			<a href="#expenses">Expenses</a>
			<a href="#reports">Reports</a>
		</div>

		<!-- Main Content -->
		<div class="content">
			<div class="container-fluid">
				<!-- Overview Section -->
				<div id="overview" class="card">
					<div class="card-header">Overview</div>
					<div class="card-body">
						<div class="row">
							<div class="col-md-4">
								<div class="card">
									<div class="card-body text-center">
										<h5 class="card-title">Total Work Orders</h5>
										<p class="card-text"><span id="total-work-orders">50</span></p>
									</div>
								</div>
							</div>
							<div class="col-md-4">
								<div class="card">
									<div class="card-body text-center">
										<h5 class="card-title">Completed Work Orders</h5>
										<p class="card-text"><span id="completed-work-orders">30</span></p>
									</div>
								</div>
							</div>
							<div class="col-md-4">
								<div class="card">
									<div class="card-body text-center">
										<h5 class="card-title">Total Employees</h5>
										<p class="card-text"><span id="total-employees">15</span></p>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>

				<!-- Scheduling Section -->
				<div id="scheduling" class="card">
					<div class="card-header">Scheduling and Planning</div>
					<div class="card-body">
						<div id="calendar"></div>
					</div>
				</div>

				<!-- Roster Management Section -->
				<div id="roster" class="card">
					<div class="card-header">Roster Management</div>
					<div class="card-body">
						<div id="timeline"></div>
					</div>
				</div>

				<!-- Work Orders Section -->
				<div id="work-orders" class="card">
					<div class="card-header">Work Orders</div>
					<div class="card-body">
						<button class="btn btn-primary" onclick="showWorkOrderForm()">Create New Work Order</button>
						<table class="table table-bordered mt-3">
							<thead>
								<tr>
									<th>Order Number</th>
									<th>Title</th>
									<th>Start Date</th>
									<th>End Date</th>
									<th>Type</th>
									<th>Priority</th>
									<th>Status</th>
									<th>Actions</th>
								</tr>
							</thead>
							<tbody id="work-orders-table">
								<!-- PHP to Fetch and Display Work Orders -->
								<?php
                                require 'db_connection.php';
                                $sql = "SELECT * FROM work_orders";
                                $result = $conn->query($sql);

                                if ($result->num_rows > 0) {
                                    while($row = $result->fetch_assoc()) {
                                        echo "<tr>
                                            <td>" . $row["work_order_number"] . "</td>
                                            <td>" . $row["title"] . "</td>
                                            <td>" . $row["start_date"] . "</td>
                                            <td>" . $row["end_date"] . "</td>
                                            <td>" . $row["work_order_type"] . "</td>
                                            <td>" . $row["priority"] . "</td>
                                            <td>" . $row["status"] . "</td>
                                            <td>
                                                <button class='btn btn-warning'>Edit</button>
                                                <button class='btn btn-danger'>Delete</button>
                                            </td>
                                        </tr>";
                                    }
                                } else {
                                    echo "<tr><td colspan='8'>No work orders found.</td></tr>";
                                }
                                $conn->close();
                                ?>
							</tbody>
						</table>
					</div>
				</div>

				<!-- Employee Management Section -->
				<div id="employees" class="card">
					<div class="card-header">Employee Management</div>
					<div class="card-body">
						<button class="btn btn-primary" onclick="showEmployeeForm()">Add New Employee</button>
						<table class="table table-bordered mt-3">
							<thead>
								<tr>
									<th>Employee ID</th>
									<th>Full Name</th>
									<th>Working Hours</th>
									<th>Performance</th>
									<th>Actions</th>
								</tr>
							</thead>
							<tbody id="employee-table">
								<!-- PHP to Fetch and Display Employees -->
								<?php
                                require 'db_connection.php';
                                $sql = "SELECT * FROM employees";
                                $result = $conn->query($sql);

                                if ($result->num_rows > 0) {
                                    while($row = $result->fetch_assoc()) {
                                        echo "<tr>
                                            <td>" . $row["employee_id"] . "</td>
                                            <td>" . $row["full_name"] . "</td>
                                            <td>" . $row["working_hours"] . "</td>
                                            <td>" . $row["performance"] . "</td>
                                            <td>
                                                <button class='btn btn-warning'>Edit</button>
                                                <button class='btn btn-danger'>Delete</button>
                                            </td>
                                        </tr>";
                                    }
                                } else {
                                    echo "<tr><td colspan='5'>No employees found.</td></tr>";
                                }
                                $conn->close();
                                ?>
							</tbody>
						</table>
					</div>
				</div>

				<!-- Fuel Consumption Section -->
				<div id="fuel" class="card">
					<div class="card-header">Fuel Consumption Monitoring</div>
					<div class="card-body">
						<div id="fuel-chart"></div>
					</div>
				</div>

				<!-- Expense Tracking Section -->
				<div id="expenses" class="card">
					<div class="card-header">Expense Tracking</div>
					<div class="card-body">
						<button class="btn btn-primary" onclick="showExpenseForm()">Add New Expense</button>
						<div id="expense-chart"></div>
					</div>
				</div>

				<!-- Reporting Section -->
				<div id="reports" class="card">
					<div class="card-header">Reporting and Analytics</div>
					<div class="card-body">
						<div id="reports-container"></div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Modals for Forms -->
	<div class="modal" id="workOrderModal">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Create New Work Order</h5>
					<button type="button" class="close" data-dismiss="modal">&times;</button>
				</div>
				<div class="modal-body">
					<form id="workOrderForm">
						<div class="form-group">
							<label for="title">Title</label>
							<input type="text" class="form-control" id="title" name="title" required>
						</div>
						<div class="form-group">
							<label for="tasks">Tasks</label>
							<input type="text" class="form-control" id="tasks" name="tasks" required>
							<button type="button" class="btn btn-secondary mt-2" onclick="addTask()">Add Task</button>
						</div>
						<div class="form-group">
							<label for="start_date">Start Date</label>
							<input type="date" class="form-control" id="start_date" name="start_date" required>
						</div>
						<div class="form-group">
							<label for="end_date">End Date</label>
							<input type="date" class="form-control" id="end_date" name="end_date" required>
						</div>
						<div class="form-group">
							<label for="work_order_type">Work Order Type</label>
							<input type="text" class="form-control" id="work_order_type" name="work_order_type"
								required>
						</div>
						<div class="form-group">
							<label for="work_order_number">Work Order Number</label>
							<input type="text" class="form-control" id="work_order_number" name="work_order_number"
								required>
						</div>
						<div class="form-group">
							<label for="priority">Priority</label>
							<select class="form-control" id="priority" name="priority" required>
								<option>High</option>
								<option>Medium</option>
								<option>Low</option>
							</select>
						</div>
						<div class="form-group">
							<label for="status">Status</label>
							<select class="form-control" id="status" name="status" required>
								<option>Pending</option>
								<option>In Progress</option>
								<option>Completed</option>
							</select>
						</div>
						<button type="submit" class="btn btn-primary">Create</button>
					</form>
				</div>
			</div>
		</div>
	</div>

	<!-- Add jQuery, Bootstrap JS, and Chart.js -->
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<script>
		// Sample function to show modal
		function showWorkOrderForm() {
			$('#workOrderModal').modal('show');
		}

		// Function to add tasks
		let tasks = [];
		function addTask() {
			const taskInput = document.getElementById('tasks');
			if (taskInput.value) {
				tasks.push(taskInput.value);
				taskInput.value = '';
				console.log('Tasks:', tasks); // For debugging
			}
		}

		// Handle form submission (example only, implement as needed)
		$('#workOrderForm').on('submit', function (event) {
			event.preventDefault();
			// Collect form data and tasks
			const formData = $(this).serializeArray();
			formData.push({ name: 'tasks', value: tasks.join(',') });
			console.log('Form Data:', formData); // For debugging
			// Add your form submission code here
			$('#workOrderModal').modal('hide');
		});
	</script>
</body>

</html>